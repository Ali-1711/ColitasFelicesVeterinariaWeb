<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resumen Clínico - Veterinario</title>
  <link rel="icon" href="data:image/jpeg;base64,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" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    .sidebar-overlay {
      transition: opacity 0.3s ease;
      z-index: 40;
        position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: rgba(0, 0, 0, 0.5);
            }

    @media (max-width: 767px) {
      body.menu-open {
        overflow: hidden;
      }
    }

    #sidebar {
      z-index: 50;
    }

    .main-content {
      margin-left: 200px;
    }
  </style>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">

  <!-- Encabezado superior -->
  <header class="bg-green-600 text-white py-4 px-4 sm:px-6 flex justify-between items-center w-full shadow-md z-20">
    <div class="flex items-center">
      <button id="menuToggle" class="mr-4 md:hidden">
        <i class="fas fa-bars text-xl"></i>
      </button>
      <h1 class="text-lg sm:text-xl font-bold">Colitas Felices</h1>
    </div>
  <div class="flex items-center space-x-3 p-2 rounded-lg bg-green-700 bg-opacity-80">
    <i class="fas fa-user-md text-lg text-green-300"></i>
    <span class="font-medium">Veterinario/a</span>
    <span id="vetName" class="font-medium">Cargando...</span>
  </div>
  </header>

  <div class="flex flex-1">
    <!-- Sidebar corregido -->
    <aside id="sidebar"
      class="w-64 bg-gray-800 text-white flex flex-col justify-between fixed h-full md:h-auto md:sticky md:top-0 left-0 z-30 transform -translate-x-full md:transform-none transition-transform duration-300 overflow-y-auto">
      <div class="p-4">
        <nav class="flex flex-col space-y-3">
          <a href="/vet/veterinarian_dashboard.html" class="flex items-center gap-3 text-green-400 bg-gray-700 p-2 rounded "><i
              class="fa-solid fa-table-columns"></i>Resumen Clínico Veterinario</a>
          <a href="/vet/veterinarian_appointments.html" class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i
              class="fa-solid fa-calendar-days"></i> Citas Agendadas</a>
          <a href="/vet/veterinarian_attend.html" class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i
              class="fa-solid fa-stethoscope"></i> Atender Cita</a>
          <a href="/vet/veterinarian_clinicalreport.html"
            class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i class="fa-solid fa-user"></i> Historial del
            Paciente</a>
          <a href="/vet/veterinarian_schedule.html" class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i
              class="fa-solid fa-clock"></i> Horario</a>
          <a href="/vet/vet_assign.html" class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i
              class="fa-solid fa-user"></i> Asignación</a>
          <a href="/vet/veterinarian_validate.html" class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i
              class="fa-solid fa-check-double"></i> Validar Evaluaciones</a>
          <a href="/vet/veterinarian_reports.html"
            class="flex items-center gap-3 p-2 rounded hover:bg-gray-700"><i class="fa-solid fa-chart-pie"></i>
            Reportes</a>
            <button onclick="logout()"
              class="m-4 flex items-center justify-center gap-2 bg-gray-100 text-red-500 px-4 py-2 rounded-lg hover:shadow-md">
              <i class="fa-solid fa-arrow-right-from-bracket"></i> Cerrar Sesión
            </button>
          </nav>
      </div>
    </aside>

    <!-- Overlay para móvil -->
    <div class="sidebar-overlay fixed inset-0 bg-black bg-opacity-50 z-40 hidden md:hidden"></div>

    <!-- Main content con margen para el sidebar -->
    <main class="flex-1 p-4 md:p-8 md:[margin-left:20px] space-y-6 transition-all duration-300">
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">Resumen Clínico Veterinario</h1>
        <div class="text-sm text-gray-500">Fecha: <span id="currentDate"></span></div>
      </div>

      <!-- Fila superior -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 md:gap-6 justify-center max-w-3xl mx-auto">
        <div
          class="bg-white p-4 md:p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between w-full hover:shadow-md">
          <div>
            <div class="text-gray-500 text-sm">Citas Hoy</div>
            <div class="text-xl md:text-2xl font-bold text-green-600" id="todayAppointments">...</div>
            <div class="text-xs md:text-sm text-gray-400">Total de citas</div>
          </div>
          <div class="bg-green-100 p-2 md:p-3 rounded-full">
            <i class="fa-regular fa-calendar text-xl md:text-2xl text-green-600"></i>
          </div>
        </div>

        <div
          class="bg-white p-4 md:p-6 rounded-lg shadow-sm border border-gray-100 flex items-center justify-between w-full hover:shadow-md">
          <div>
            <div class="text-gray-500 text-sm">Pacientes Atendidos</div>
            <div class="text-xl md:text-2xl font-bold text-green-600" id="weekPatients">...</div>
            <div class="text-xs md:text-sm text-gray-400">Esta semana</div>
          </div>
          <div class="bg-green-100 p-2 md:p-3 rounded-full">
            <i class="fa-solid fa-user-check text-xl md:text-2xl text-green-600"></i>
          </div>
        </div>
      </div>

      <!-- Fila inferior -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6">
        <div class="bg-white p-4 md:p-6 rounded-lg shadow-sm border border-gray-100 w-full">
          <h2 class="text-lg font-semibold mb-4 text-gray-700">Servicios Brindados</h2>
          <div class="chart-container" style="position: relative; height:250px; width:100%">
            <canvas id="servicesChart"></canvas>
          </div>
        </div>

        <div class="bg-white p-4 md:p-6 rounded-lg shadow-sm border border-gray-100 w-full">
          <div class="flex justify-between mb-4 gap-2">
            <div>Calendario de citas</div>
            <div class="flex items-center justify-center sm:justify-end space-x-2 sm:space-x-4">
              <button id="prevPeriod" class="text-green-600 hover:text-green-800 text-sm sm:text-base">&lt;</button>
              <div id="calendarTitle" class="text-xs sm:text-sm font-medium text-gray-700 text-center">...</div>
              <button id="nextPeriod" class="text-green-600 hover:text-green-800 text-sm sm:text-base">&gt;</button>
            </div>
          </div>

          <!-- Vista de mes -->
          <div>
            <div class="grid grid-cols-7 gap-1 text-center text-gray-600 text-xs sm:text-sm mb-2">
              <div>Dom</div>
              <div>Lun</div>
              <div>Mar</div>
              <div>Mié</div>
              <div>Jue</div>
              <div>Vie</div>
              <div>Sáb</div>
            </div>
            <div id="monthDays" class="grid grid-cols-7 gap-1 text-center"></div>
          </div>

          <div class="mt-4 flex flex-wrap items-center justify-center gap-2 sm:gap-4">
            <div class="flex items-center">
              <div class="w-2 h-2 sm:w-3 sm:h-3 bg-blue-200 rounded-full mr-1 sm:mr-2"></div><span
                class="text-xs">Programada</span>
            </div>
            <div class="flex items-center">
              <div class="w-2 h-2 sm:w-3 sm:h-3 bg-green-200 rounded-full mr-1 sm:mr-2"></div><span
                class="text-xs">Completada</span>
            </div>
            <div class="flex items-center">
              <div class="w-2 h-2 sm:w-3 sm:h-3 bg-red-200 rounded-full mr-1 sm:mr-2"></div><span
                class="text-xs">Cancelada</span>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
document.addEventListener('DOMContentLoaded', () => {
    // Cargar nombre del veterinario
    fetch('/api/vet/current-vet-name', {
        credentials: 'include'
    })
    .then(response => {
        if (!response.ok) throw new Error('Error al obtener datos del veterinario');
        return response.json();
    })
    .then(data => {
        document.getElementById('vetName').textContent = data.fullName;
        
        // Opcional: Si quieres mostrar la especialidad
        // document.getElementById('vetSpecialization').textContent = data.specialization;
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('vetName').textContent = 'Veterinario';
    });

    // ... resto de tus llamadas fetch existentes
});

    // Mostrar fecha actual
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    document.getElementById('currentDate').textContent = new Date().toLocaleDateString('es-ES', options);

    // Elementos del menú móvil
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.querySelector('.sidebar-overlay');
    const mainContent = document.querySelector('main');

   // Función para alternar el menú - versión corregida
function toggleMenu() {
  const isOpen = sidebar.classList.contains('-translate-x-full');
  
  if (isOpen) {
    // Abrir menú
    sidebar.classList.remove('-translate-x-full');
    sidebarOverlay.classList.remove('hidden');
    document.body.classList.add('overflow-hidden');
  } else {
    // Cerrar menú
    sidebar.classList.add('-translate-x-full');
    sidebarOverlay.classList.add('hidden');
    document.body.classList.remove('overflow-hidden');
  }
}

    // Eventos para el menú móvil
    menuToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleMenu();
    });

    sidebarOverlay.addEventListener('click', toggleMenu);

    // Cerrar menú al cambiar a vista desktop
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 768) {
        sidebar.classList.remove('-translate-x-full');
        sidebarOverlay.classList.add('hidden');
        document.body.classList.remove('overflow-hidden');
      }
    });

    function cargarGraficoServicios() {

      fetch('/api/vet/completed-services-summary', { credentials: 'include' })
        .then(res => res.json())
        .then(data => {

          const canvas = document.getElementById('servicesChart');
          if (!canvas) {
            console.error("❌ No se encontró el canvas #servicesChart en el HTML");
            return;
          }

          const ctx = canvas.getContext('2d');

          const labels = Object.keys(data);
          const values = Object.values(data);

          if (labels.length === 0) {
            console.warn("⚠ No hay datos para mostrar en el gráfico de servicios.");
            ctx.font = "16px Arial";
            ctx.fillText("No hay servicios completados.", 10, 50);
            return;
          }

          if (window.servicesChart) {
            window.servicesChart.destroy();
          }

          const colors = ['#60A5FA','#34D399','#A78BFA','#FBBF24','#F87171','#F472B6','#FCD34D'];

          window.servicesChart = new Chart(ctx, {
            type: 'pie',
            data: {
              labels,
              datasets: [{
                data: values,
                backgroundColor: colors.slice(0, labels.length)
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  position: 'bottom'
                }
              }
            }
          });

        })
        .catch(err => console.error("Error al cargar gráfico de servicios:", err));
    }

    document.addEventListener("DOMContentLoaded", cargarGraficoServicios);


    function logout() {
      document.cookie = "jwt=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC; SameSite=Lax";
      window.location.href = "/";
    }

    const calendarTitle = document.getElementById('calendarTitle');
    const monthDays = document.getElementById('monthDays');

    const now = new Date();
    let currentDate = new Date();

    document.getElementById('prevPeriod').addEventListener('click', () => {
      currentDate.setMonth(currentDate.getMonth() - 1);
      renderCalendar();
    });

    document.getElementById('nextPeriod').addEventListener('click', () => {
      currentDate.setMonth(currentDate.getMonth() + 1);
      renderCalendar();
    });

    function renderCalendar() {
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      const totalDays = new Date(year, month + 1, 0).getDate();
      const firstDay = new Date(year, month, 1).getDay();

      calendarTitle.textContent = currentDate.toLocaleDateString('es-ES', { month: 'long', year: 'numeric' });
      monthDays.innerHTML = '';
      for (let i = 0; i < firstDay; i++) monthDays.innerHTML += '<div class="h-6 sm:h-8"></div>';

      fetch(`/api/vet/appointments-by-month?ym=${year}-${String(month + 1).padStart(2, '0')}`, { credentials: 'include' })
        .then(res => res.json())
        .then(data => {
          for (let d = 1; d <= totalDays; d++) {
            const key = d.toString();
            const estado = data[key];
            let className = "h-6 sm:h-8 flex items-center justify-center rounded-full text-xs sm:text-sm";

            if (estado === "PROGRAMADA") className += " bg-blue-200";
            else if (estado === "COMPLETADA") className += " bg-green-200";
            else if (estado === "CANCELADA") className += " bg-red-200";
            else className += " bg-gray-100";

            monthDays.innerHTML += `<div class="${className}" title="${estado || 'Sin citas'}">${d}</div>`;
          }
        })
        .catch(err => {
          console.error("Error al cargar calendario:", err);
          for (let d = 1; d <= totalDays; d++) {
            monthDays.innerHTML += `<div class="h-6 sm:h-8 flex items-center justify-center text-xs sm:text-sm">${d}</div>`;
          }
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
      fetch('/api/vet/today-appointments-count', { credentials: 'include' })
        .then(res => res.json())
        .then(data => document.getElementById('todayAppointments').textContent = data ?? 0);

      fetch('/api/vet/week-patients-count', { credentials: 'include' })
        .then(res => res.json())
        .then(data => document.getElementById('weekPatients').textContent = data ?? 0);

      cargarGraficoServicios();
      renderCalendar();
    });
  </script>
</body>

</html>